\usepackage{listings}
\usepackage{xstring}
\usepackage{courier}

\newcommand{\code}[1]{%
  \begingroup\noexpandarg
  \texttt{\StrSubstitute{#1}{_}{\_}}%
  \endgroup
}


\lstset{
  basicstyle=\footnotesize\ttfamily,
  frame=single,
  commentstyle=\color{gray},
  showstringspaces=false,
  keywordstyle=\bfseries\color{blue!40!black},
  commentstyle=\itshape\color{grey!40!black},
  stringstyle=\color{green}
}

\lstdefinestyle{thesis}{
  basicstyle=\footnotesize\ttfamily,
  frame=single,
  numbers=left,
  commentstyle=\color{gray},
  showstringspaces=false
}
\newcommand{\thesislisting}[2]{%
  \begin{figure}
    \lstinputlisting[language=erlang,style=thesis]{implementation/code/#1.erl}
    \vspace{-0.5cm}
    \caption{#2}
    \label{#1}
  \end{figure}
}

\lstdefinestyle{appendix}{
  basicstyle=\scriptsize\ttfamily,
  frame=single,
  commentstyle=\color{gray}
}
\newcommand{\appendixlisting}[1]{%
  \begingroup\noexpandarg
  \StrSubstitute{#1}{_}{\_}[\mllcap]%
  \lstinputlisting[caption=\mllcap, language=erlang, style=appendix]{../implementation/join/#1}%
  \endgroup
}
