\usepackage{environ}
\usepackage{xargs}
\usepackage{ifthen}
\usepackage{xifthen}

\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{stmaryrd}
\usepackage{mathtools}
\usepackage{float}
\usepackage{bussproofs}


\newcommand{\parens}[1]{\left(#1\right)}

% TODO: one equation or multiple???
\NewEnviron{JFig}[1]{%
  \begin{figure}[H]
    \BODY
    \caption{#1}
  \end{figure}
}

\NewEnviron{JDef}[1]{%
  \begin{figure}[H]
    \begin{equation}
      \begin{split}
        \BODY
      \end{split}
    \end{equation}
    \caption{#1}
  \end{figure}
}

\newcommand{\grmr}{\ ::=&\ \ }
\newcommand{\altn}{\\ \big|&\ \ }
\newcommand{\alt}{\ \big|\ }

\newcommand{\reduction}{\longrightarrow}

% pi calculus
\newcommand{\pnullproc}{\textbf{0}}
\newcommand{\ppar}{\ |\ }
\newcommand{\prep}[1]{!#1}
\newcommand{\pnew}{\@ifstar{\@pnewp}{\@pnewn}}
\newcommand{\@pnewp}[2]{(\nu #1)\parens{#2}}
\newcommand{\@pnewn}[2]{(\nu #1)#2}
\newcommand{\psnd}[2]{\overline{#1}#2}
\newcommand{\prcv}[2]{#1(#2)}
\newcommand{\pchc}{+}

% join calculus
\newcommand{\jsnd}[2]{#1\langle#2\rangle}
\newcommand{\jdef}[2]{\textbf{def} \ #1 \ \textbf{in} \ #2}
\newcommand{\jpar}{\ |\ }
\newcommand{\jnullproc}{\textbf{0}}
\newcommand{\jrct}[2]{#1 \vartriangleright #2}
\newcommand{\jcon}{\wedge}
\newcommand{\jnulldef}{\boldsymbol{\top}}
\newcommand{\jrcv}[2]{#1\langle#2\rangle}
\newcommand{\jpat}{\ |\ }

% actor pi
\newcommand{\anullproc}{\textbf{0}}
\newcommand{\arcv}[2]{#1(#2)}  % TODO: parens?
\newcommand{\asnd}[2]{\overline{#1}\langle#2\rangle}
\newcommand{\anew}{\@ifstar{\@anewp}{\@anewn}}
\newcommand{\@anewp}[2]{(\nu #1)\parens{#2}}
\newcommand{\@anewn}[2]{(\nu #1)#2}
\newcommand{\apar}{\ |\ }
\newcommand{\acse}[2]{\textbf{case} \ #1 \ \textbf{of} \ \parens{#2}}
\newcommand{\aalt}[2]{#1 : #2}
\newcommand{\ains}[3]{#1 \langle #2 ; #3 \rangle}
\newcommand{\adef}{\@ifstar{\@adefa}{\@adefn}}
\newcommand{\@adefa}[4]{#1 &\overset{\mathclap{\mathit{def}}}{=} \left( #2 ; #3 \right) #4}
\newcommand{\@adefn}[4]{#1 \overset{\mathit{def}}{=} \left( #2 ; #3 \right) #4}

% actor pi judgement
\newcommand{\judgement}[3]{%
  \ifthenelse{\isempty{#1}}{\emptyset}{\{#1\}}%
  ;\ifthenelse{\isempty{#2}}{\{\}}{#2}%
  \vdash #3}
\newcommand{\ch}[1]{ch(#1)}


\newcommand{\bn}[1]{\operatorname{bn}\parens{#1}}
\newcommand{\fn}[1]{\operatorname{fn}\parens{#1}}
\newcommand{\names}[1]{\operatorname{n}\parens{#1}}
\newcommand{\subst}[2]{\{#1 / #2\}}

\newcommand{\encMJtoAP}[1]{\llbracket #1 \rrbracket}

\newcommand{\abbreviation}[2]{#1 \ \ &\text{for} \ \ #2}

% bussproofs
\newcommand{\axiom}[1]{\AxiomC{$#1$}}
\newcommand{\infI}[2]{\LeftLabel{\textsc{#1}:}\UnaryInfC{$#2$}}
\newcommand{\infII}[2]{\LeftLabel{\textsc{#1}:}\BinaryInfC{$#2$}}
% TODO: number argument

\newcommand{\infrule}[3]{%
  \begin{prooftree}
    \AxiomC{$#2$}
    \LeftLabel{\textsc{#1} : }
    \UnaryInfC{$#3$}
  \end{prooftree}
}
\newcommand{\infruleIII}[5]{
  \begin{prooftree}
    \AxiomC{$#2$}
    \AxiomC{$#3$}
    \AxiomC{$#4$}
    \LeftLabel{\textsc{#1} : }
    \TrinaryInfC{$#5$}
  \end{prooftree}
}
